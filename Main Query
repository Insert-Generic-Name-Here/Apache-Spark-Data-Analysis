COPY "MainT" FROM 'D:\db2_project_data\Test.csv' WITH CSV HEADER DELIMITER ','
VACUUM FULL "MainT"
--1.B
ALTER SYSTEM SET shared_buffers TO '2GB'
--1.C
ALTER SYSTEM SET max_worker_processes TO '16'
ALTER SYSTEM SET max_parallel_workers_per_gather TO '16'
ALTER SYSTEM SET dynamic_shared_memory_type TO 'windows'
SELECT pg_reload_conf();

--1.A.i
SELECT id,max(kilometers) FROM "MainT" 
WHERE timestamp <='2016-12-05 06:00:00' AND kilometers = (
    SELECT max(kilometers) 
 	FROM "MainT" 
 	WHERE timestamp <='2016-12-05 06:00:00')
GROUP BY id;

--1.A.ii
SELECT avg(kilometers) FROM "MainT"
WHERE EXTRACT(month FROM timestamp) = EXTRACT(month FROM (SELECT max(timestamp) FROM "MainT"));

--1.A.iii
SELECT id, EXTRACT(month FROM timestamp),sum(kilometers) FROM "MainT"
GROUP BY id, EXTRACT(month FROM timestamp);

--1.A.iv
SELECT id,avg(kilometers) FROM "MainT"
GROUP BY id

--1.A.v
SELECT region_id,avg(kilometers) FROM "MainT"
GROUP BY region_id





